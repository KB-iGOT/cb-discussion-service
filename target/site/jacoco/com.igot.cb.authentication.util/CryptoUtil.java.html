<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CryptoUtil.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">cb-discussion-service</a> &gt; <a href="index.source.html" class="el_package">com.igot.cb.authentication.util</a> &gt; <span class="el_source">CryptoUtil.java</span></div><h1>CryptoUtil.java</h1><pre class="source lang-java linenums">package com.igot.cb.authentication.util;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.nio.charset.Charset;
import java.nio.charset.StandardCharsets;
import java.security.*;


/**
 * @author Mahesh RV
 */
public class CryptoUtil {
<span class="fc" id="L15">    private static final Charset US_ASCII = StandardCharsets.US_ASCII;</span>
<span class="fc" id="L16">    private static final Logger logger = LoggerFactory.getLogger(CryptoUtil.class.getName());</span>

    private CryptoUtil(){}

    /**
     * Verifies an RSA signature using the provided payload, signature, public key, and algorithm.
     *
     * @param payLoad    The payload to be verified.
     * @param signature  The signature to be verified.
     * @param key        The public key used for verification.
     * @param algorithm  The algorithm used for verification.
     * @return true if the signature is valid, false otherwise.
     */
    public static boolean verifyRSASign(String payLoad, byte[] signature, PublicKey key, String algorithm) {
        Signature sign;
        try {
            // Initialize a Signature instance with the provided algorithm
<span class="fc" id="L33">            sign = Signature.getInstance(algorithm);</span>
            // Initialize the Signature instance with the public key for verification
<span class="fc" id="L35">            sign.initVerify(key);</span>
            // Update the Signature instance with the payload bytes
<span class="fc" id="L37">            sign.update(payLoad.getBytes(US_ASCII));</span>
<span class="fc" id="L38">            return sign.verify(signature);</span>
<span class="fc" id="L39">        } catch (NoSuchAlgorithmException | InvalidKeyException | SignatureException e) {</span>
<span class="fc" id="L40">            logger.error(&quot;An error occurred during RSA signature verification: {}&quot;, e.getMessage(), e);</span>
<span class="fc" id="L41">            return false;</span>
        }
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>